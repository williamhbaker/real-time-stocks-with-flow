---
collections:
  examples/quotes:
    schema:
      properties:
        AskExchange:
          type: string
        AskPrice:
          type: number
        AskSize:
          type: integer
        BidExchange:
          type: string
        BidPrice:
          type: number
        BidSize:
          type: integer
        Conditions:
          type: array
        Symbol:
          type: string
        Tape:
          type: string
        Timestamp:
          type: string
      required:
        - Symbol
        - Timestamp
      type: object
    key:
      - /Symbol
      - /Timestamp
  examples/trades:
    schema:
      properties:
        Conditions:
          type: array
        Exchange:
          type: string
        ID:
          type: integer
        Price:
          type: number
        Size:
          type: integer
        Symbol:
          type: string
        Tape:
          type: string
        Timestamp:
          type: string
      required:
        - ID
        - Symbol
      type: object
    key:
      - /ID
      - /Symbol
    projections:
      trade_size: /Size
      trade_timestamp: /Timestamp
  examples/trades2:
    schema:
      properties:
        conditions:
          type: array
        exchange:
          type: string
        id:
          type: integer
        price:
          type: number
        trade_size:
          type: integer
        symbol:
          type: string
        tape:
          type: string
        trade_timestamp:
          type: string
      required:
        - id
        - symbol
      type: object
    key:
      - /id
      - /symbol

materializations:
  examples/postgres:
    endpoint:
      connector:
        image: "ghcr.io/estuary/materialize-postgres:dev"
        config: postgres.config.yaml
    bindings:
      - resource:
          table: trades
        source: examples/trades
        # fields:
        #   recommended: true
        #   exclude: ["flow_document"]
      - resource:
          table: quotes
        source: examples/quotes
      - resource:
          table: trades2
        source: examples/trades2

captures:
  examples/source-kafka:
    endpoint:
      connector:
        image: "ghcr.io/estuary/source-kafka:dev"
        config: source-kafka.config.yaml
    bindings:
      - resource:
          stream: trades
          syncMode: incremental
        target: examples/trades
      - resource:
          stream: quotes
          syncMode: incremental
        target: examples/quotes

  examples/source-postgres:
    endpoint:
      connector:
        image: "ghcr.io/estuary/source-postgres:dev"
        config: postgres.config.yaml
    bindings:
      - resource:
          stream: trades
          syncMode: incremental
        target: examples/trades2
